<!DOCTYPE html>
<html>
<head> 
<meta charset="utf-8"> 
<title>AccessControlSystem</title> 
</head>

<style type="text/css">
        .parent_box{
			text-align: center;
            width: auto;
            height: auto;
			margin: auto;
        }

        .child_box{
            display: flex; 
			justify-content: space-around;
			width: auto;
			height: auto;
			background: #aaa;
			margin: auto;
		}

</style>

    <body bgcolor=#aaa> 
        <script>
			<!-- 该网页为私人使用，请不要尝试攻击,谢谢~ -->
			
			function getQueryVariable(variable)
			{
				var query = window.location.search.substring(1);
				var vars = query.split("&");
				for (var i=0;i<vars.length;i++) 
				{
					var pair = vars[i].split("=");
					if(pair[0] == variable){return pair[1];}
				}
				return(false);
			}
			var _id = getQueryVariable("id");
			
			function custom_close()
			{
				window.opener=null;
				window.open('','_self');
				window.close();        
			}   
			
			while ("0009" != _id)
			{
				password = prompt('请输入密码:','');
			}

			var g_addr = 'ws://movie.fxtexture.com:9001/';
				
            function switchPic() {
                //element.src="pic_bulboff.png";
                element.src="pic_hello"+ Math.floor((Math.random()*5)+1) +".png";
            }
			
			function switchText() {
				var g_text = document.getElementById("p2");
                g_text.innerHTML = "欢迎回家~ !";
            }
			
            function myrefresh() {
                element = document.getElementById('myimage');
                if (element.src.match("bulbon"))
                {
                    element.src="pic_bulboff.png";
                }
                else
                {
                    element.src="pic_bulbon.png";
					socket = new WebSocket(g_addr);
					socket.addEventListener('open', function (event) {contactServer();});
					var g_text = document.getElementById("p2");
					g_text.innerHTML = "正在开门...";
					setTimeout(switchPic, 400);
					setTimeout(switchText, 400);
                }
                
            }
			
			contactServer = () =>
			{
				socket.send("UnlockDoor");
            }
			
        </script>
    
</script>
		<!-- 该网页为私人使用，请不要尝试攻击,谢谢~ -->
		<div class="parent_box">
				<p style="font-size:150px">门禁控制</p>
				<p id="p2" style="font-size:60px">“按下解锁”</p>
				<img loading="lazy" id="myimage" onclick="myrefresh()" src="pic_bulboff.png" width="500" height="500">
				<p style="font-size:60px">AccessControlSystem</p>
		</div>

    </body >
</html>